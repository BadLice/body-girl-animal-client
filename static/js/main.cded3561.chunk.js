(this["webpackJsonpbody-girl-animal-client"]=this["webpackJsonpbody-girl-animal-client"]||[]).push([[0],{122:function(e,t){},132:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(22),l=a.n(c),i=(a(93),a(10)),u=(a(61),a(77)),s=a.n(u),m=a(144),o=a(81),d=a(142),f=a(140),b=a(135),E=a(79),h=function(e){var t=Object(n.useRef)(),a=Object(n.useRef)(),c=function(e,t){e.preventDefault(),e.stopPropagation(),t&&t()};return r.a.createElement(r.a.Fragment,null,r.a.createElement(d.a,{className:"bg-light justify-content-between",bg:"dark",variant:"dark"},r.a.createElement(f.a,{inline:!0,onSubmit:function(a){return c(a,(function(){return e.saveUsername(t.current.value.trim())}))}},r.a.createElement(b.a,{className:"mr-sm-2",onChange:function(){return e.setUsernameSaved(""===t.current.value.trim())}},r.a.createElement(b.a.Prepend,null,r.a.createElement(b.a.Text,{id:"basic-addon1"},r.a.createElement("span",{role:"img","aria-label":"user-avatar-icon"},"\ud83d\udc64"))),r.a.createElement(E.a,{ref:t,placeholder:"Username","aria-label":"Username","aria-describedby":"basic-addon1",defaultValue:e.username})),r.a.createElement(o.a,{onClick:function(){return e.saveUsername(t.current.value.trim())},disabled:e.usernameSaved},"Save")),r.a.createElement(f.a,{inline:!0,onSubmit:function(t){return c(t,(function(){return e.setSeatchText(a.current.value.trim())}))}},r.a.createElement(o.a,{variant:"success",className:" mr-sm-2",onClick:function(){return e.createGame()}},"Create game"),r.a.createElement(E.a,{ref:a,type:"text",placeholder:"Type ID or name...",className:" mr-sm-2"}),r.a.createElement(o.a,{onClick:function(){return e.setSeatchText(a.current.value.trim())}},"Search"))))},g=a(20),v=a(139),p=a(80),S=a(143),I=function(e){var t=function(){e.connection.emit("reqQuitGame"),e.setShow(!1)},a=function(){return{value:"",ref:Object(n.createRef)()}},c=Object(n.useState)([a()]),l=Object(i.a)(c,2),u=l[0],s=l[1],m=Object(n.useRef)(),d=Object(n.useState)([]),b=Object(i.a)(d,2),h=b[0],I=b[1];Object(n.useEffect)((function(){if(e.connection)return e.connection.on("getUsersConnected",(function(e){return I(e)})),function(){return e.connection.off("getUsersConnected")}}),[e.connection]);return r.a.createElement(r.a.Fragment,null,r.a.createElement(v.a,{show:e.show,onHide:t},r.a.createElement(v.a.Header,{closeButton:!0},r.a.createElement(v.a.Title,null,"Create a game")),r.a.createElement(v.a.Body,null,r.a.createElement(p.a,{className:"font-weight-bold"},"ID"),r.a.createElement(p.a,{className:"font-weight-bold text-danger",variant:"danger"},e.newGameId)),r.a.createElement(v.a.Body,null,r.a.createElement(p.a,{className:"font-weight-bold"},"Name"),r.a.createElement(E.a,{type:"text",placeholder:"Game name...",ref:m})),r.a.createElement(v.a.Body,null,r.a.createElement(p.a,{className:"font-weight-bold"},"Fields"),u.map((function(e,t){return r.a.createElement(f.a,{key:t,inline:!0,className:" mt-1",onSubmit:function(e){return function(e,t){e.preventDefault(),e.stopPropagation(),t&&t()}(e)}},r.a.createElement(f.a.Control,{ref:u[t].ref,type:"text",placeholder:"Istert field...",style:{width:"80%"},className:" mr-sm-1",onChange:function(){return function(e,t){var a=Object(g.a)(u);a[e].value=a[e].ref.current.value.trim(),s(a)}(t)},value:u[t].value}),u.length>1?r.a.createElement(o.a,{variant:"danger",className:" mr-sm-1",onClick:function(){return function(e){var t=Object(g.a)(u);t.splice(e,1),s(t)}(t)}},"-"):"",t===u.length-1?r.a.createElement(o.a,{variant:"success",className:" mr-sm-1",onClick:function(){s(Object(g.a)(u).concat(a()))}},"+"):"")}))),r.a.createElement(v.a.Body,null,r.a.createElement(p.a,{className:"font-weight-bold"},"Users connected"),r.a.createElement(S.a,null,h.map((function(e,t){return r.a.createElement(S.a.Item,{key:t},e.name)})))),r.a.createElement(v.a.Footer,null,r.a.createElement(o.a,{variant:"secondary",onClick:t},"Close"),r.a.createElement(o.a,{variant:"primary",onClick:function(){e.connection.emit("startGame",{gameId:e.newGameId,name:m.current.value.trim(),columns:u.map((function(e){return e.value}))}),e.history.push("/game?id="+e.newGameId),e.setShow(!1)}},"Start game"))))},y=function(e){var t=j(e.connection),a=Object(n.useState)(""),c=Object(i.a)(a,2),l=c[0],u=c[1],s=Object(n.useState)(!1),d=Object(i.a)(s,2),f=d[0],b=d[1],E=Object(n.useState)(null),g=Object(i.a)(E,2),v=g[0],p=g[1];return r.a.createElement(r.a.Fragment,null,r.a.createElement(h,{createGame:function(){e.connection.emit("reqCreateGame"),e.connection.on("getCreateGame",(function(e){p(e),b(!0)}))},setSeatchText:u,saveUsername:e.saveUsername,setUsernameSaved:e.setUsernameSaved,username:e.username,usernameSaved:e.usernameSaved}),r.a.createElement(I,{show:f,newGameId:v,setShow:b,connection:e.connection,history:e.history}),t.filter((function(e){return e.id.includes(l)||e.name.includes(l)})).map((function(t){return r.a.createElement(m.a,{key:t.id,border:"primary",className:"m-2 game-card"},r.a.createElement(m.a.Body,null,r.a.createElement(m.a.Title,null,t.name),r.a.createElement(m.a.Text,null,r.a.createElement("br",null),r.a.createElement("span",{className:"border border-dark p-3 mt-3"},t.users.map((function(e,a){return r.a.createElement("span",{key:a},e.name,a!==t.users.length-1?r.a.createElement(r.a.Fragment,null,", "):"")}))),r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement("span",null,"ID:",r.a.createElement("span",{className:"text-primary m-1"},t.id))),r.a.createElement(o.a,{variant:"primary",onClick:function(){return a=t.id,e.connection.emit("reqJoinGame",a),void e.connection.on("getJoinGame",(function(t){t&&e.history.push("/game?id="+a)}));var a}},"Join")))})))},j=function(e){var t=Object(n.useState)([]),a=Object(i.a)(t,2),r=a[0],c=a[1];return Object(n.useEffect)((function(){if(e)return e.emit("reqGames"),e.on("getGames",(function(e){return c(e)})),function(){return e.off("getGames")}}),[e]),r},O=a(141),k=a(138),w=a(136),C=a(50),N=function(e){var t="";switch(e.toggle){case 0:t="danger";break;case 5:t="primary";break;case 10:t="success";break;default:t="danger"}return"confirmed"!==e.handState?r.a.createElement(b.a.Prepend,null,r.a.createElement(b.a.Text,{className:t},e.toggle)):r.a.createElement(w.a,{disabled:e.disabled,onSelect:function(t){return e.setInputScore(t,e.handId,e.inputIndex)},as:b.a.Prepend,variant:t,title:e.toggle},r.a.createElement(C.a.Item,{eventKey:0},"0"),r.a.createElement(C.a.Item,{eventKey:5},"5"),r.a.createElement(C.a.Item,{eventKey:10},"10"))},U=function(e){var t=Object(n.useRef)();return r.a.createElement(r.a.Fragment,null,r.a.createElement("td",{className:"align-middle"},r.a.createElement(b.a,{size:"sm",className:"mb-3"},"playing"!==e.state?r.a.createElement(N,{handId:e.handId,inputIndex:e.index,toggle:e.input.score,handState:e.handState,setInputScore:e.setInputScore}):"",r.a.createElement(E.a,{ref:t,"aria-label":"Small","aria-describedby":"inputGroup-sizing-sm",disabled:"playing"!==e.handState,defaultValue:e.input.value,onBlur:function(){return e.setInputValue(t.current.value,e.handId,e.index)}}))))},x=function(e){var t;switch(e.hand.state){case"playing":t=r.a.createElement(o.a,{variant:"success",onClick:function(){return e.confirmHand(e.hand.id)}},"Confirm");break;case"waiting":t=r.a.createElement(o.a,{variant:"success",onClick:function(){return e.confirmHand(e.hand.id)},disabled:!0},"Confirmed");break;case"confirmed":t=r.a.createElement(o.a,{variant:"primary",onClick:function(){return e.submitHand(e.hand.id)}},"Submit");break;default:t=r.a.createElement("h6",null,"Submitted")}return r.a.createElement(r.a.Fragment,null,r.a.createElement("td",{className:"align-middle"},t))},H=function(e){var t=e.hand.inputs.reduce((function(e,t){return e+t.score}),0);return r.a.createElement(r.a.Fragment,null,r.a.createElement("td",{className:"align-middle"},e.hand.character),e.hand.inputs.map((function(t,a){return r.a.createElement(U,{key:a,index:a,handId:e.hand.id,input:t,handState:e.hand.state,setInputScore:e.setInputScore,setInputValue:e.setInputValue,state:e.hand.state})})),r.a.createElement(x,{hand:e.hand,confirmHand:e.confirmHand,submitHand:e.submitHand}),r.a.createElement("td",{className:"align-middle"},t))},G=function(e){return r.a.createElement(r.a.Fragment,null,e.hands.map((function(t,a){return r.a.createElement("tr",{key:a,className:"text-center align-middle"},r.a.createElement(H,{hand:t,setInputScore:e.setInputScore,setInputValue:e.setInputValue,confirmHand:e.confirmHand,submitHand:e.submitHand}))})))},T=a(137),F=function(e){var t=e.hands.reduce((function(e,t){return e+t.inputs.reduce((function(e,t){return e+t.score}),0)}),0);return r.a.createElement(r.a.Fragment,null,r.a.createElement("footer",{className:"w-100 p-1 bg-dark text-white fixed-bottom"},r.a.createElement(T.a,{variant:"primary",className:"float-right m-0"},t),r.a.createElement(T.a,{variant:"none",className:"float-right m-0"},"TOTAL")))},q=function(e){return r.a.createElement(r.a.Fragment,null,r.a.createElement(d.a,{className:"justify-content-between",bg:"dark",variant:"dark"},r.a.createElement(f.a,{inline:!0},r.a.createElement(b.a,{className:"mr-sm-2"},r.a.createElement(b.a.Prepend,null,r.a.createElement(b.a.Text,{id:"basic-addon1"},r.a.createElement("span",{role:"img","aria-label":"user-avatar-icon"},"\ud83d\udc64"))),r.a.createElement(E.a,{placeholder:"Username","aria-label":"Username","aria-describedby":"basic-addon1",defaultValue:e.username,disabled:!0}))),r.a.createElement(f.a,{inline:!0},r.a.createElement(o.a,{variant:"danger",onClick:function(){return e.quitGame()}},"Quit game"))))},B=function(e){return r.a.createElement(r.a.Fragment,null,r.a.createElement(q,{username:e.username,quitGame:function(){e.connection.emit("reqQuitGame"),e.connection.on("getQuitGame",(function(){return e.history.push("/")}))}}),r.a.createElement(k.a,{striped:!0,bordered:!0,hover:!0,responsive:!0,variant:"dark"},r.a.createElement("thead",null,r.a.createElement("tr",null,e.columns.map((function(e,t){return r.a.createElement("th",{key:t},e)})))),r.a.createElement("tbody",null,r.a.createElement(G,{hands:e.hands,setInputScore:function(t,a,n){var r=e.hands.findIndex((function(e){return e.id===a})),c=Object(g.a)(e.hands);c[r].inputs[n].score=Number(t),e.setHands(c)},setInputValue:function(t,a,n){var r=e.hands.findIndex((function(e){return e.id===a})),c=Object(g.a)(e.hands);c[r].inputs[n].value=t,e.setHands(c)},confirmHand:function(t){var a=e.hands.findIndex((function(e){return e.id===t})),n=Object(g.a)(e.hands);n[a].state="waiting",e.setHands(n)},submitHand:function(t){var a=e.hands.findIndex((function(e){return e.id===t})),n=Object(g.a)(e.hands);n[a].state="submitted",e.setHands(n)}}))),r.a.createElement(F,{columns:e.columns,hands:e.hands}))},V=a(27),P=function(e,t){var a=Object(n.useState)([]),r=Object(i.a)(a,2),c=r[0],l=r[1];return Object(n.useEffect)((function(){if(t&&e)return t.emit("reqColumns",e),t.on("getColumns",(function(e){return l(e.concat(["Actions","Total"]))})),function(){return t.off("getColumns")}}),[e]),[c,l]},D=function(e,t,a){var r=Object(n.useState)([]),c=Object(i.a)(r,2),l=c[0],u=c[1];return Object(n.useEffect)((function(){if(t&&e)return t.emit("reqHands",{gameId:e,userId:a}),t.on("getHands",(function(e){return u(e)})),function(){return t.off("getHands")}}),[e,a]),[l,u]},R=function(e,t,a,r,c){var l=Object(n.useState)(null),u=Object(i.a)(l,2),m=u[0],o=u[1];return Object(n.useEffect)((function(){var n=s()(e,{"force new connection":!0,reconnectionAttempts:"Infinity",timeout:1e4,transports:["websocket"]});return!t||0===Object.keys(t).length&&t.constructor===Object?n.emit("reqUserId"):n.emit("reqUsername",t),n.on("getUsername",(function(e){r(e),c(!0)})),n.on("getUserId",(function(e){return a("userId",e.id,{maxAge:28800})&&r(e.name)})),console.log("SOCKET ID: "+n.id),o(n),function(){n.off("getUsername"),n.off("getUserId")}}),[e,t,a,r,c]),m},J=function(){return new URLSearchParams(Object(V.g)().search)};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var A=a(58);l.a.render(r.a.createElement(A.a,null,r.a.createElement((function(){var e=Object(V.f)(),t=J().get("id");console.log("gameId: "+t);var a=Object(O.a)(["body-girl-animal-userId"]),c=Object(i.a)(a,3),l=c[0].userId,u=c[1],s=(c[2],Object(n.useState)(!1)),m=Object(i.a)(s,2),o=m[0],d=m[1],f=Object(n.useState)(""),b=Object(i.a)(f,2),E=b[0],h=b[1],g=R("http://localhost:15519",l,u,h,d),v=P(t,g),p=Object(i.a)(v,2),S=p[0],I=p[1],j=D(t,g,l),k=Object(i.a)(j,2),w=k[0],C=k[1],N=function(e){g.emit("reqSaveUsername",{id:l,name:e}),g.on("getSaveUsername",(function(t){return t&&d(!0)&&h(e)}))};return r.a.createElement(V.c,null,r.a.createElement(V.a,{path:"/game"},r.a.createElement(B,{connection:g,setColumns:I,setHands:C,saveUsername:N,usernameSaved:o,setUsernameSaved:d,username:E,columns:S,hands:w,gameId:t,history:e})),r.a.createElement(V.a,{path:"/"},r.a.createElement(y,{connection:g,setColumns:I,setHands:C,saveUsername:N,usernameSaved:o,setUsernameSaved:d,username:E,gameId:t,history:e})))}),null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},88:function(e,t,a){e.exports=a(132)},93:function(e,t,a){}},[[88,1,2]]]);
//# sourceMappingURL=main.cded3561.chunk.js.map