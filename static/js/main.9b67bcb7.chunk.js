(this["webpackJsonpbody-girl-animal-client"]=this["webpackJsonpbody-girl-animal-client"]||[]).push([[0],{125:function(e,t){},134:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(11),i=a.n(c),l=(a(96),a(33)),u=a(7),s=(a(67),a(84)),m=a.n(s),o=a(148),d=a(88),f=a(146),E=a(143),b=a(137),g=a(86),h=function(e){var t=Object(n.useRef)(),a=Object(n.useRef)(),c=function(e,t){e.preventDefault(),e.stopPropagation(),t&&t()};return r.a.createElement(r.a.Fragment,null,r.a.createElement(f.a,{className:"bg-light justify-content-between",bg:"dark",variant:"dark"},r.a.createElement(E.a,{inline:!0,onSubmit:function(a){return c(a,(function(){return e.saveUsername(t.current.value.trim())}))}},r.a.createElement(b.a,{className:"mr-sm-2",onChange:function(){return e.setUsernameSaved(""===t.current.value.trim())}},r.a.createElement(b.a.Prepend,null,r.a.createElement(b.a.Text,{id:"basic-addon1"},r.a.createElement("span",{role:"img","aria-label":"user-avatar-icon"},"\ud83d\udc64"))),r.a.createElement(g.a,{ref:t,placeholder:"Username","aria-label":"Username","aria-describedby":"basic-addon1",defaultValue:e.username})),r.a.createElement(d.a,{onClick:function(){return e.saveUsername(t.current.value.trim())},disabled:e.usernameSaved},"Save")),r.a.createElement(E.a,{inline:!0,onSubmit:function(t){return c(t,(function(){return e.setSeatchText(a.current.value.trim())}))}},r.a.createElement(d.a,{variant:"success",className:" mr-sm-2",onClick:function(){return e.createGame()}},"Create game"),r.a.createElement(g.a,{ref:a,type:"text",placeholder:"Type ID or name...",className:" mr-sm-2"}),r.a.createElement(d.a,{onClick:function(){return e.setSeatchText(a.current.value.trim())}},"Search"))))},v=a(56),p=a(19),j=a(142),O=a(87),S=a(147),I=function(e){var t=function(){e.connection.emit("reqQuitGame"),e.setShow(!1)},a=function(){return{value:"",ref:Object(n.createRef)()}},c=Object(n.useState)([a()]),i=Object(u.a)(c,2),l=i[0],s=i[1],m=Object(n.useRef)(),o=Object(n.useState)({valid:!0,value:60,ref:Object(n.createRef)()}),f=Object(u.a)(o,2),b=f[0],h=f[1],I=function(){s(Object(p.a)(l).map((function(e){return Object(v.a)({},e,{valid:""!==e.value.trim()})})));var e=!isNaN(b.ref.current.value.trim()),t=Object(v.a)({},b);t.valid=e,e&&(t.value=0===b.ref.current.value.trim().length?60:Number(b.ref.current.value.trim())),console.log(t.value),h(Object(v.a)({},b,{valid:t.valid,value:t.value}))};return r.a.createElement(r.a.Fragment,null,r.a.createElement(j.a,{show:e.show,onHide:t},r.a.createElement(j.a.Header,{closeButton:!0},r.a.createElement(j.a.Title,null,"Create a game")),r.a.createElement(j.a.Body,null,r.a.createElement(O.a,{className:"font-weight-bold"},"ID"),r.a.createElement(O.a,{className:"font-weight-bold text-danger",variant:"danger"},e.newGameId)),r.a.createElement(j.a.Body,null,r.a.createElement(O.a,{className:"font-weight-bold"},"Name"),r.a.createElement(g.a,{type:"text",placeholder:"Game name...",ref:m})),r.a.createElement(j.a.Body,null,r.a.createElement(O.a,{className:"font-weight-bold"},"Timer"),r.a.createElement(g.a,{type:"text",placeholder:"60",ref:b.ref,isInvalid:!b.valid,onBlur:I})),r.a.createElement(j.a.Body,null,r.a.createElement(O.a,{className:"font-weight-bold"},"Fields"),l.map((function(e,t){return r.a.createElement(E.a,{key:t,inline:!0,className:" mt-1",onSubmit:function(e){return function(e,t){e.preventDefault(),e.stopPropagation(),t&&t()}(e)}},r.a.createElement(E.a.Control,{isInvalid:!e.valid,ref:e.ref,type:"text",placeholder:"Istert field...",style:{width:"80%"},className:" mr-sm-1",onChange:function(){return function(e,t){var a=Object(p.a)(l);a[e].value=a[e].ref.current.value.trim(),s(a)}(t)},value:e.value,onBlur:I}),l.length>1?r.a.createElement(d.a,{variant:"danger",className:" mr-sm-1",onClick:function(){return function(e){var t=Object(p.a)(l);t.splice(e,1),s(t)}(t)}},"-"):"",t===l.length-1?r.a.createElement(d.a,{variant:"success",className:" mr-sm-1",onClick:function(){s(Object(p.a)(l).concat(a()))}},"+"):"")}))),r.a.createElement(j.a.Body,null,r.a.createElement(O.a,{className:"font-weight-bold"},"Users connected"),r.a.createElement(S.a,null,e.users.map((function(e,t){return r.a.createElement(S.a.Item,{key:t},e.name)})))),r.a.createElement(j.a.Footer,null,r.a.createElement(d.a,{variant:"secondary",onClick:t},"Close"),r.a.createElement(d.a,{variant:"primary",onClick:function(){var t=!0;l.forEach((function(e){return t&=e.valid})),(t&=b.valid)&&(e.connection.emit("startGame",{defaultTimer:b.value,gameId:e.newGameId,name:m.current.value.trim(),columns:l.map((function(e){return e.value.trim()}))}),e.history.push("/game?id="+e.newGameId),e.setShow(!1))}},"Start game"))))},y=function(e){var t=w(e.connection),a=Object(n.useState)(""),c=Object(u.a)(a,2),i=c[0],l=c[1],s=Object(n.useState)(!1),m=Object(u.a)(s,2),f=m[0],E=m[1],b=Object(n.useState)(null),g=Object(u.a)(b,2),v=g[0],p=g[1];return r.a.createElement(r.a.Fragment,null,r.a.createElement(h,{createGame:function(){e.connection.emit("reqCreateGame"),e.connection.off("getCreateGame"),e.connection.on("getCreateGame",(function(e){p(e),E(!0)}))},setSeatchText:l,saveUsername:e.saveUsername,setUsernameSaved:e.setUsernameSaved,username:e.username,usernameSaved:e.usernameSaved}),r.a.createElement(I,{show:f,newGameId:v,setShow:E,connection:e.connection,history:e.history,users:e.users}),t.filter((function(e){return e.id.includes(i)||e.name.includes(i)})).map((function(t){return r.a.createElement(o.a,{key:t.id,border:"primary",className:"m-2 game-card"},r.a.createElement(o.a.Body,null,r.a.createElement(o.a.Title,null,t.name),r.a.createElement(o.a.Text,null,r.a.createElement("br",null),r.a.createElement("span",{className:"border border-dark p-3 mt-3"},t.users.map((function(e,a){return r.a.createElement("span",{key:a},e.name,a!==t.users.length-1?r.a.createElement(r.a.Fragment,null,", "):"")}))),r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement("span",null,"ID:",r.a.createElement("span",{className:"text-primary m-1"},t.id))),r.a.createElement(d.a,{variant:"primary",onClick:function(){return a=t.id,void e.history.push("/game?id="+a);var a}},"Join")))})))},w=function(e){var t=Object(n.useState)([]),a=Object(u.a)(t,2),r=a[0],c=a[1];return Object(n.useEffect)((function(){if(e)return e.emit("reqGames"),e.on("getGames",(function(e){return c(e)})),function(){e.off("getCreateGame"),e.off("getGames")}}),[e]),r},N=a(145),C=a(140),k=a(141),x=a(138),U=a(57),G=function(e){var t="";switch(e.toggle){case 0:t="danger";break;case 5:t="primary";break;case 10:t="success";break;default:t="danger"}return"confirmed"!==e.handState?r.a.createElement(b.a.Prepend,null,r.a.createElement(b.a.Text,{className:t},e.toggle)):r.a.createElement(x.a,{disabled:e.disabled,onSelect:function(t){return e.setInputScore(t,e.handId,e.inputIndex)},as:b.a.Prepend,variant:t,title:e.toggle},r.a.createElement(U.a.Item,{eventKey:0},"0"),e.inputValid?r.a.createElement(r.a.Fragment,null,r.a.createElement(U.a.Item,{eventKey:5},"5"),r.a.createElement(U.a.Item,{eventKey:10},"10")):"")},H=function(e){var t=Object(n.useRef)(),a=Object(n.useState)(!0),c=Object(u.a)(a,2),i=c[0],l=c[1],s=function(t){e.setInputValue(t,e.handId,e.index,e.character),function(t){var a=t.trim().toUpperCase().charAt(0)===e.character.toUpperCase().charAt(0)||0===t.length;l(a)}(t)};return Object(n.useEffect)((function(){if("playing"!==e.handState){var a=t.current.value.trim().toUpperCase().charAt(0)===e.character.toUpperCase().charAt(0);l(a),i||(t.current.value="",e.setInputScore(0,e.handId,e.index))}}),[e.handState,i]),r.a.createElement(r.a.Fragment,null,r.a.createElement("td",{className:"align-middle"},r.a.createElement(b.a,{size:"sm",className:"mb-3"},"playing"!==e.state?r.a.createElement(G,{handId:e.handId,inputIndex:e.index,toggle:e.input.score,handState:e.handState,setInputScore:e.setInputScore,inputValid:i}):"",r.a.createElement(g.a,{isInvalid:!i,ref:t,"aria-label":"Small","aria-describedby":"inputGroup-sizing-sm",disabled:"playing"!==e.handState,defaultValue:e.input.value,onChange:function(){return s(t.current.value.trim())}}))))},T=function(e){var t;switch(e.hand.state){case"playing":t=r.a.createElement(d.a,{variant:"success",onClick:function(){return e.confirmHand(e.hand.id)}},"Confirm");break;case"waiting":t=r.a.createElement(d.a,{variant:"success",onClick:function(){return e.confirmHand(e.hand.id)},disabled:!0},"Confirmed");break;case"confirmed":t=r.a.createElement(d.a,{variant:"primary",onClick:function(){return e.submitHand(e.hand.id)}},"Submit");break;default:t=r.a.createElement("h6",null,"Submitted")}return r.a.createElement(r.a.Fragment,null,r.a.createElement("td",{className:"align-middle"},t))},F=a(139),q=function(e){var t=e.hand.inputs.reduce((function(e,t){return e+t.score}),0);return r.a.createElement(r.a.Fragment,null,r.a.createElement("td",{className:"align-middle"},e.showSpinner?r.a.createElement(F.a,{animation:"grow",variant:"success",className:"float-left"}):r.a.createElement(r.a.Fragment,null),e.hand.character),e.hand.inputs.map((function(t,a){return r.a.createElement(H,{key:a,index:a,handId:e.hand.id,character:e.hand.character,input:t,handState:e.hand.state,setInputScore:e.setInputScore,setInputValue:e.setInputValue,state:e.hand.state})})),r.a.createElement(T,{hand:e.hand,confirmHand:e.confirmHand,submitHand:e.submitHand}),r.a.createElement("td",{className:"align-middle"},t))},B=function(e){return r.a.createElement(r.a.Fragment,null,e.hands.map((function(t,a){return r.a.createElement("tr",{key:a,className:"text-center align-middle"},r.a.createElement(q,{showSpinner:a===e.hands.length-1,hand:t,setInputScore:e.setInputScore,setInputValue:e.setInputValue,confirmHand:e.confirmHand,submitHand:e.submitHand}))})))},R=function(e){var t=e.hands.reduce((function(e,t){return e+t.inputs.reduce((function(e,t){return e+t.score}),0)}),0);return r.a.createElement(r.a.Fragment,null,r.a.createElement("footer",{className:"w-100 p-1 bg-dark text-white fixed-bottom"},r.a.createElement(C.a,{variant:"primary",className:"float-right m-0"},t),r.a.createElement(C.a,{variant:"none",className:"float-right m-0"},"TOTAL")))},V=a(149),A=a(144),J=function(e){var t=r.a.createElement(V.a,{id:"scoreBoard"},r.a.createElement(V.a.Title,{as:"h3"},"Scoreboard"),r.a.createElement(V.a.Content,null,r.a.createElement(S.a,{variant:"flush"},e.users.sort((function(e,t){return e.score>t.score})).map((function(e,t){var a="";switch(t){case 0:a="text-success";break;case 2:a="text-danger";break;case 1:a="text-warning"}return r.a.createElement(S.a.Item,{key:t},r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-xs-6 mr-2 "},r.a.createElement("span",{style:{visibility:0===t?"visible":"hidden"}},"\ud83d\udc51")),r.a.createElement("div",{className:"col-xs-6 mr-2 "+a},e.score),r.a.createElement("div",{className:"col-xs-6 "},e.name)))})))));return r.a.createElement(r.a.Fragment,null,r.a.createElement(f.a,{className:"justify-content-between",bg:"dark",variant:"dark"},r.a.createElement(E.a,{inline:!0},r.a.createElement(b.a,{className:"mr-sm-2"},r.a.createElement(b.a.Prepend,null,r.a.createElement(b.a.Text,{id:"basic-addon1"},r.a.createElement("span",{role:"img","aria-label":"user-avatar-icon"},"\ud83d\udc64"))),r.a.createElement(g.a,{placeholder:"Username","aria-label":"Username","aria-describedby":"basic-addon1",defaultValue:e.username,disabled:!0})),r.a.createElement(A.a,{trigger:"click",placement:"bottom",overlay:t},r.a.createElement(d.a,{variant:"info"},"\u2630"))),r.a.createElement(E.a,{inline:!0},r.a.createElement(E.a.Label,{className:"mr-sm-2 text-warning h4"},e.timer),r.a.createElement(d.a,{variant:"danger",onClick:function(){return e.quitGame()}},"Quit game"))))},P=function(e){return r.a.createElement(r.a.Fragment,null,r.a.createElement(C.a,{variant:"info",className:"m-3"},r.a.createElement(C.a.Heading,null,"Game is starting ...",r.a.createElement(F.a,{animation:"grow",variant:"danger",className:"float-right"})),r.a.createElement("hr",null),r.a.createElement("p",null,"Connected users"),r.a.createElement(S.a,null,e.users.map((function(e,t){return r.a.createElement(S.a.Item,{key:t},e.name)})))))},D=function(e){var t=Q(e.connection);Object(n.useEffect)((function(){if(e.connection&&e.gameId)return e.connection.emit("reqJoinGame",e.gameId),e.connection.off("getJoinGame"),e.connection.on("getJoinGame",(function(t){t&&e.connection.emit("reqGameStarted",e.gameId)})),function(){return e.connection.off("getJoinGame")}}),[e.connection,e.gameId]);var a=function(){e.connection.emit("reqQuitGame"),e.connection.off("getQuitGame"),e.connection.on("getQuitGame",(function(){return e.history.push("/")}))};return e.gameExists?r.a.createElement(r.a.Fragment,null,r.a.createElement(J,{username:e.username,quitGame:a,users:e.users,timer:t}),e.gameStarted?r.a.createElement(r.a.Fragment,null,r.a.createElement(k.a,{striped:!0,bordered:!0,hover:!0,responsive:!0,variant:"dark"},r.a.createElement("thead",null,r.a.createElement("tr",null,e.columns.map((function(e,t){return r.a.createElement("th",{key:t},e)})))),r.a.createElement("tbody",null,r.a.createElement(B,{hands:e.hands,setInputScore:function(t,a,n){var r=e.hands.findIndex((function(e){return e.id===a})),c=Object(p.a)(e.hands);c[r].inputs[n].score=Number(t),e.setHands(c)},setInputValue:function(t,a,n,r){if(t.trim().toUpperCase().charAt(0)===r.toUpperCase().charAt(0)){var c=e.hands.findIndex((function(e){return e.id===a})),i=Object(p.a)(e.hands);i[c].inputs[n].value=t,e.setHands(i)}},confirmHand:function(t){var a=e.hands.findIndex((function(e){return e.id===t})),n=Object(p.a)(e.hands);n[a].state="waiting",e.setHands(n)},submitHand:function(t){var a=e.hands.findIndex((function(e){return e.id===t})),n=Object(p.a)(e.hands);n[a].state="submitted",e.setHands(n)}}))),r.a.createElement(R,{columns:e.columns,hands:e.hands})):r.a.createElement(P,{users:e.users})):r.a.createElement(r.a.Fragment,null,r.a.createElement(J,{username:e.username,quitGame:a,users:e.users,timer:t}),r.a.createElement(C.a,{variant:"danger",className:"m-3"},r.a.createElement(C.a.Heading,null,"ERROR 404"),r.a.createElement("p",null,"Not found"),r.a.createElement("hr",null),r.a.createElement("p",{className:"mb-0"},"This game does not exists!")))},Q=function(e){var t=Object(n.useState)("sync..."),a=Object(u.a)(t,2),r=a[0],c=a[1];return Object(n.useEffect)((function(){if(e)return e.off("syncTimer"),e.on("syncTimer",(function(e){return c(e)})),function(){return e.off("syncTimer")}}),[e]),r},K=a(28),L=function(e,t){var a=Object(n.useState)(!1),r=Object(u.a)(a,2),c=r[0],i=r[1];return Object(n.useEffect)((function(){if(t&&e)return t.emit("reqGameExists",e),t.on("getGameExists",(function(e){return i(e)})),function(){return t.off("getGameExists")}}),[t,e]),[c,i]},z=function(e,t,a,r){var c=Object(n.useState)([]),i=Object(u.a)(c,2),l=i[0],s=i[1];return Object(n.useEffect)((function(){if(t&&e&&a&&r)return t.emit("reqColumns",e),t.off("getColumns"),t.on("getColumns",(function(e){return s(["Character"].concat(e.concat(["Actions","Total"])))})),function(){return t.off("getColumns")}}),[e,t,a,r]),[l,s]},W=function(e,t,a,r,c){var i=Object(n.useState)([]),l=Object(u.a)(i,2),s=l[0],m=l[1];return Object(n.useEffect)((function(){if(t&&e&&r&&c)return t.emit("reqHands",{gameId:e,userId:a}),t.off("getHands"),t.on("getHands",(function(e){return m(e)})),function(){t.off("handTimeout"),t.off("getHands")}}),[e,t,a,r,c]),[s,m]},$=function(e,t,a,r,c){var i=Object(n.useState)(null),l=Object(u.a)(i,2),s=l[0],o=l[1];return Object(n.useEffect)((function(){var n=m()(e,{"force new connection":!0,reconnectionAttempts:"Infinity",timeout:1e4,transports:["websocket"]});return!t||0===Object.keys(t).length&&t.constructor===Object?n.emit("reqUserId"):n.emit("reqUsername",t),n.off("getUsername"),n.on("getUsername",(function(e){r(e),c(!0)})),n.off("getUserId"),n.on("getUserId",(function(e){return a("userId",e.id,{maxAge:28800})&&r(e.name)})),o(n),function(){n.off("getUsername"),n.off("getUserId")}}),[e,t,a,r,c]),s},M=function(e,t,a,r){var c=Object(n.useState)(!1),i=Object(u.a)(c,2),l=i[0],s=i[1];return Object(n.useEffect)((function(){if(r&&t&&e&&a)return r.emit("reqGameStarted",t),r.off("getGameStarted"),r.on("getGameStarted",(function(e){return s(e)})),function(){return r.off("getGameStarted")}}),[e,t,a,r]),[l,s]},X=function(){return new URLSearchParams(Object(K.g)().search)};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var Y=a(46);i.a.render(r.a.createElement(Y.a,null,r.a.createElement((function(){var e,t=Object(K.f)(),a=Object(N.a)(["body-girl-animal-userId"]),c=Object(u.a)(a,3),i=c[0].userId,s=c[1],m=(c[2],Object(n.useState)(!1)),o=Object(u.a)(m,2),d=o[0],f=o[1],E=Object(n.useState)(""),b=Object(u.a)(E,2),g=b[0],h=b[1],v=$("http://worddd.cloudno.de",i,s,h,f),p=X().get("id"),j=L(p,v),O=Object(u.a)(j,2),S=O[0],I=(O[1],M(S,p,i,v)),w=Object(u.a)(I,2),C=w[0],k=(w[1],z(p,v,S,C)),x=Object(u.a)(k,2),U=x[0],G=x[1],H=W(p,v,i,S,C),T=Object(u.a)(H,2),F=T[0],q=T[1],B=Object(n.useState)([]),R=Object(u.a)(B,2),V=R[0],A=R[1];Object(n.useEffect)((function(){v&&i&&p&&F&&(v.off("handTimeout"),v.on("handTimeout",(function(){v.emit("handTimeoutClientResponse",{hands:F,userId:i,gameId:p})})))}),[v&&i&&p&&F]),Object(n.useEffect)((function(){if(v)return v.off("getUsersConnected"),v.on("getUsersConnected",(function(e){return A(e)})),function(){return v.off("getUsersConnected")}}),[v]);var J=function(e){v.emit("reqSaveUsername",{id:i,name:e}),v.off("getSaveUsername"),v.on("getSaveUsername",(function(t){return t&&f(!0)&&h(e)}))};return r.a.createElement(K.c,null,r.a.createElement(K.a,{path:"/game"},r.a.createElement(D,(e={connection:v,setColumns:G,setHands:q,saveUsername:J,usernameSaved:d,setUsernameSaved:f,username:g,columns:U,hands:F,gameId:p,history:t},Object(l.a)(e,"gameId",p),Object(l.a)(e,"gameExists",S),Object(l.a)(e,"users",V),Object(l.a)(e,"gameStarted",C),e))),r.a.createElement(K.a,{path:"/"},r.a.createElement(y,{connection:v,setColumns:G,setHands:q,saveUsername:J,usernameSaved:d,setUsernameSaved:f,username:g,gameId:p,history:t,users:V,gameStarted:C})))}),null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},91:function(e,t,a){e.exports=a(134)},96:function(e,t,a){}},[[91,1,2]]]);
//# sourceMappingURL=main.9b67bcb7.chunk.js.map